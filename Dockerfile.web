FROM python:3.10
RUN apt-get -y update && \
    apt-get -y upgrade && \
    apt-get install -y ffmpeg && \
    curl -fsSL https://deb.nodesource.com/setup_lts.x | bash - && \
    apt-get install -y nodejs
RUN pip install -U pip
RUN npm install -g npm
RUN mkdir -p /src
ADD ./requirements.txt /src/requirements.txt
ADD ./app/package.json /src/package.json
ADD ./app/package-lock.json /src/package-lock.json
WORKDIR /src
RUN pip install -r requirements.txt
RUN npm install -g
RUN chmod +x run.sh
EXPOSE $SERVER_PORT $PORT